!function(p){"use strict";var a,r={serverPath:"./src/plugins/upload/trumbowyg.upload.php",fileFieldName:"fileToUpload",data:[],headers:{},xhrFields:{},urlPropertyName:"file",statusPropertyName:"success",success:void 0,error:void 0};function s(r,e){var a=e.shift();if(null!==r){if(0===e.length)return r[a];if("object"==typeof r)return s(r[a],e)}return r}p.trumbowyg||p.trumbowyg.addedXhrProgressEvent||(a=p.ajaxSettings.xhr,p.ajaxSetup({xhr:function(){var r=a(),e=this;return r&&"object"==typeof r.upload&&void 0!==e.progressUpload&&r.upload.addEventListener("progress",function(r){e.progressUpload(r)},!1),r}}),p.trumbowyg.addedXhrProgressEvent=!0),p.extend(!0,p.trumbowyg,{langs:{en:{upload:"Upload",file:"File",uploadError:"Error"},sk:{upload:"Nahrať",file:"Súbor",uploadError:"Chyba"},fr:{upload:"Envoi",file:"Fichier",uploadError:"Erreur"},cs:{upload:"Nahrát obrázek",file:"Soubor",uploadError:"Chyba"},zh_cn:{upload:"上传",file:"文件",uploadError:"错误"}},plugins:{upload:{init:function(u){u.o.plugins.upload=p.extend(!0,{},r,u.o.plugins.upload||{}),u.addBtnDef("upload",{fn:function(){u.saveRange();var o,t=u.o.prefix,l=u.openModalInsert(u.lang.upload,{file:{type:"file",required:!0},alt:{label:"description",value:u.getRangeText()}},function(a){var e=new FormData;e.append(u.o.plugins.upload.fileFieldName,o),u.o.plugins.upload.data.map(function(r){e.append(r.name,r.value)}),0===p("."+t+"progress",l).length&&p("."+t+"modal-title",l).after(p("<div/>",{class:t+"progress"}).append(p("<div/>",{class:t+"progress-bar"}))),p.ajax({url:u.o.plugins.upload.serverPath,headers:u.o.plugins.upload.headers,xhrFields:u.o.plugins.upload.xhrFields,type:"POST",data:e,cache:!1,dataType:"json",processData:!1,contentType:!1,progressUpload:function(r){p("."+t+"progress-bar").stop().animate({width:Math.round(100*r.loaded/r.total)+"%"},200)},success:u.o.plugins.upload.success||function(r){var e;s(r,u.o.plugins.upload.statusPropertyName.split("."))?(e=s(r,u.o.plugins.upload.urlPropertyName.split(".")),u.execCmd("insertImage",e),p('img[src="'+e+'"]:not([alt])',u.$box).attr("alt",a.alt),setTimeout(function(){u.closeModal()},250),u.$c.trigger("tbwuploadsuccess",[u,r,e])):(u.addErrorOnModalField(p("input[type=file]",l),u.lang[r.message]),u.$c.trigger("tbwuploaderror",[u,r]))},error:u.o.plugins.upload.error||function(){u.addErrorOnModalField(p("input[type=file]",l),u.lang.uploadError),u.$c.trigger("tbwuploaderror",[u])}})});p("input[type=file]").on("change",function(e){try{o=e.target.files[0]}catch(r){o=e.target.value}})}})}}}})}(jQuery);